<html>

<head>
    <title>Rainydays AlbumUpload demo</title>
    <link rel="stylesheet" href="assets/demo.css"></link>
    <link rel="stylesheet" href="assets/jquery-ui.css"></link>
</head>

<body>
    
    <div id="uploadButtonHolder">
        <span id="uploadButton"></span>
        <span id="uploadInstructions">Check out Rainydays!<br/>Upload a few pictures.</span>
    </div>
    
    
    <form id="demoForm">
        <div id="deletedImagesHolder">
            <div class="title">
                Deleted Images
            </div>
            
            <div id="deletedImages"></div>
        </div>
        
        <div id="AlbumUploads">
            <div id="AlbumUploadsPlaceholder">
                (Your images will show up here!)
            </div>
        </div>

        <div class="clearFloat">&nbsp;</div>
    </form>

    <div id="outputContainer">
        <div class="outputTitle">Form output:</div>
        <div id="output"></div>
    </div>
        
    <script type="text/javascript" src="javascript/jquery.dev.js"></script>
    <script type="text/javascript" src="javascript/jquery-ui.js"></script>
    <script type="text/javascript" src="javascript/Jaml-all.js"></script>
    <script type="text/javascript" src="javascript/swfupload.js"></script>
    <script type="text/javascript" src="javascript/swfobject.js"></script>

    <script type="text/javascript" src="../rainydays.js"></script>
    <script type="text/javascript" src="../albumupload.js"></script>
    <script type="text/javascript" src="../uploadmanager.js"></script>

    <script>
    var uploader;
    $(document).ready(function() {
        uploader = RD.AlbumUpload.newUploader({
            albumContainerID: "AlbumUploads",
            // keyPicStorageID: "meal_key_picture_id",
            placeholderID: "AlbumUploadsPlaceholder",
            processServerResults: function(data) {
                data.thumbImageURL = data.thumb.url; 
                data.fullImageURL = data.full.url;
                data.width = data.full.width;
                data.height = data.full.height;
            },
            swfuploadOptions: {
                // file limits
            	file_types: "*.jpg; *.jpeg; *.png; *.gif",
            	file_types_description: "JPG, GIF, and PNG files only.",
                file_size_limit: "5MB",

            	// button settings
            	button_image_url: "assets/file_upload_button.png",
            	button_width: 51,
            	button_height: 50,
            	button_cursor: SWFUpload.CURSOR.HAND,
                button_placeholder_id: "uploadButton",

                flash_url: "swfupload.swf",
                upload_url: "http://10.0.1.7/~ahkoppel2/uploader/uploader.php"
            }
        })
        
        // HOOKING INTO EVENTS
        // you can hook into sort and upload events
        // here, we update the example form output
        var output = $("#output");
        var updateOutput = function() {
            output.html(unescape($("#demoForm").serialize()));
        }
        uploader.albumContainer.bind("fileUploadCompleted", updateOutput).bind("sortupdate", updateOutput).bind("imageDeleted", updateOutput).bind("imageUndeleted", updateOutput);
        
        // you can also hook into the fileUploadCompleted event to store additional data
        // here we store the size of the original file based on the server's return value
        // this shows you can access and store any of the values sent by your server 
        uploader.albumContainer.bind("fileUploadCompleted", function(event, data) {
            var image = data.image;
            image.addData("size", image.details.full.size)
        })
        
        uploader.albumContainer.bind("imageDeleted", function(effect, data) {
            var img = data.image.node, content = img.find(".imageContent"), deletedArea = $("#deletedImages");

            // show the deleted images area
            $("#deletedImagesHolder").addClass("imagesDeleted");
            
            // add a dummy image
            var spaceHolder = img.find(".thumbnail").clone();
            spaceHolder.css("visibility", "hidden");
            deletedArea.append(spaceHolder);
            
            // now transfer to it
            content.fadeOut();
            img.effect("transfer", {to: spaceHolder}, "normal", function() {
                spaceHolder.css("visibility", "visible");
                spaceHolder.replaceWith(img);
                content.fadeIn();
            });
        })
    })
    </script>

</body>

</html>
